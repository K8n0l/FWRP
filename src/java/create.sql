DROP DATABASE IF EXISTS FWRP;

CREATE DATABASE FWRP;

USE FWRP;

CREATE TABLE USERS
(
	ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	USER_NAME VARCHAR(50) NOT NULL,
	PASSWORD VARCHAR(50) NOT NULL,
	USER_TYPE ENUM('RETAIL', 'CUSTOMER','CHARITY') NOT NULL,
	PHONE_NUMBER VARCHAR(50) NOT NULL,
	EMAIL VARCHAR(50) NOT NULL,
	IS_SUBSCRIBED BOOLEAN NOT NULL
);

CREATE TABLE FOOD
(
	ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	NAME VARCHAR(50) NOT NULL,
	QUANTITY INT NOT NULL,
	PRICE DECIMAL(8,2) NOT NULL,
	FOOD_TYPE ENUM('DAIRY', 'PERISHABLE','CARBOHYDRATE','DRINK') NOT NULL,
	EXPIRATION_DATE DATE,
	USER_ID INT NOT NULL,
	FOREIGN KEY(USER_ID) REFERENCES USERS(ID)
);

CREATE TABLE SURPLUS_FOOD
(
    ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    NAME VARCHAR(50) NOT NULL,
    QUANTITY INT NOT NULL,
    FOOD_TYPE ENUM('DAIRY', 'PERISHABLE', 'CARBOHYDRATE', 'DRINK') NOT NULL,
    EXPIRATION_DATE DATE,
    PRICE DECIMAL(8,2) NOT NULL,
    DISCOUNT_RATE DECIMAL(8,2) NOT NULL,
    IS_FOR_DONATION BOOLEAN NOT NULL,
    USER_ID INT NOT NULL,
    FOREIGN KEY(USER_ID) REFERENCES USERS(ID)
);

CREATE TABLE SUBSCRIPTION
(
	ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	USER_ID INT NOT NULL,
	CONTACT_TYPE ENUM('TEXT', 'EMAIL') NOT NULL,
	PREFERENCE_TYPE ENUM('DAIRY', 'PERISHABLE', 'CARBOHYDRATE', 'DRINK') NOT NULL,
        RETAILER_USERNAME VARCHAR(50) NOT NULL, 
	FOREIGN KEY(USER_ID) REFERENCES USERS(ID)
);

CREATE TABLE ALERT
(
	ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	USER_ID INT NOT NULL,
        MESSAGE VARCHAR(1024) NOT NULL, 
	FOREIGN KEY(USER_ID) REFERENCES USERS(ID)
);

INSERT INTO USERS (USER_NAME, PASSWORD, USER_TYPE, PHONE_NUMBER, EMAIL, IS_SUBSCRIBED) VALUES
('Metro', 'securepass1','RETAIL', '613-999-9999', 'contact@metro.com', FALSE),
('Kroger', 'kroger1234', 'RETAIL', '800-666-1234', 'support@kroger.com', false),
('BJs', 'bjpassword', 'RETAIL', '800-777-5678', 'info@bjs.com', FALSE),
('Aldi', 'aldi456', 'RETAIL', '800-888-9876', 'customer.service@aldi.com', FALSE),
('John Smith', 'johnpass', 'CUSTOMER', '613-555-5555', 'john.smith@gmail.com', TRUE),
('Emily Davis', 'emilypass', 'CUSTOMER', '555-222-3333', 'emily.davis@email.com', true),
('Michael Brown', 'michaelpass', 'CUSTOMER', '555-777-8888', 'michael.brown@email.com', true),
('Goodwill', 'goodwillpass', 'CHARITY', '613-444-4444', 'info@goodwill.com', TRUE),
('UNICEF', 'unicef123', 'CHARITY', '555-444-6666', 'contact@unicef.org', true),
('Habitat for Humanity', 'habitat456', 'CHARITY', '555-999-1111', 'support@habitat.org', true);

INSERT INTO FOOD (NAME, QUANTITY, PRICE, FOOD_TYPE, EXPIRATION_DATE, USER_ID) VALUES
('Butter', 12, 3.49, 'DAIRY', '2024-05-01', (SELECT ID FROM USERS WHERE USER_NAME = 'Metro')),
('Cream Cheese', 8, 5.00, 'DAIRY', '2024-05-10', (SELECT ID FROM USERS WHERE USER_NAME = 'Kroger')),
('Bacon', 15, 4.99, 'PERISHABLE', '2024-04-25', (SELECT ID FROM USERS WHERE USER_NAME = 'Metro')),
('Bagels', 18, 2.99, 'CARBOHYDRATE', '2024-05-15', (SELECT ID FROM USERS WHERE USER_NAME = 'BJs')),
('Bananas', 40, 0.99, 'PERISHABLE', '2024-04-20', (SELECT ID FROM USERS WHERE USER_NAME = 'Metro')),
('Turkey', 10, 8.99, 'PERISHABLE', '2024-04-30', (SELECT ID FROM USERS WHERE USER_NAME = 'Aldi')),
('Carrots', 30, 1.75, 'CARBOHYDRATE', '2024-05-05', (SELECT ID FROM USERS WHERE USER_NAME = 'BJs')),
('Lemonade', 15, 3.75, 'DRINK', '2024-05-20', (SELECT ID FROM USERS WHERE USER_NAME = 'Aldi')),
('Spaghetti', 12, 2.25, 'CARBOHYDRATE', '2024-05-25', (SELECT ID FROM USERS WHERE USER_NAME = 'Kroger')),
('Cottage Cheese', 9, 2.75, 'DAIRY', '2024-05-03', (SELECT ID FROM USERS WHERE USER_NAME = 'Aldi')),
('Quinoa', 25, 5.50, 'CARBOHYDRATE', '2024-05-30', (SELECT ID FROM USERS WHERE USER_NAME = 'Kroger'));

INSERT INTO SURPLUS_FOOD (NAME, QUANTITY, FOOD_TYPE, EXPIRATION_DATE, PRICE, IS_FOR_DONATION, DISCOUNT_RATE, USER_ID) VALUES
('Greek Yogurt', 6, 'DAIRY', '2024-05-07', 2.00, TRUE, 0.20, (SELECT ID FROM USERS WHERE USER_NAME = 'Metro')),
('Grapes', 15, 'PERISHABLE', '2024-04-25', 0.60, TRUE, 0.25, (SELECT ID FROM USERS WHERE USER_NAME = 'Metro')),
('Pork Chops', 7, 'PERISHABLE', '2024-04-27', 7.50, TRUE, 0.15, (SELECT ID FROM USERS WHERE USER_NAME = 'Aldi')),
('Whole Wheat Bread', 5, 'CARBOHYDRATE', '2024-05-10', 2.25, TRUE, 0.30, (SELECT ID FROM USERS WHERE USER_NAME = 'BJs')),
('Brown Rice', 10, 'CARBOHYDRATE', '2024-05-15', 4.75, TRUE, 0.10, (SELECT ID FROM USERS WHERE USER_NAME = 'Kroger')),
('Swiss Cheese', 4, 'DAIRY', '2024-05-20', 3.00, TRUE, 0.25, (SELECT ID FROM USERS WHERE USER_NAME = 'Kroger')),
('Peaches', 9, 'PERISHABLE', '2024-04-20', 0.80, TRUE, 0.10, (SELECT ID FROM USERS WHERE USER_NAME = 'BJs')),
('Lamb', 5, 'PERISHABLE', '2024-04-25', 11.00, TRUE, 0.20, (SELECT ID FROM USERS WHERE USER_NAME = 'Aldi')),
('Granola', 6, 'CARBOHYDRATE', '2024-05-10', 2.75, TRUE, 0.25, (SELECT ID FROM USERS WHERE USER_NAME = 'Kroger')),
('Grape Juice', 12, 'DRINK', '2024-05-15', 3.00, TRUE, 0.20, (SELECT ID FROM USERS WHERE USER_NAME = 'Aldi')),
('Almond Butter', 7, 'CARBOHYDRATE', '2024-05-05', 4.25, TRUE, 0.15, (SELECT ID FROM USERS WHERE USER_NAME = 'BJs')),
('Cucumbers', 10, 'PERISHABLE', '2024-04-22', 1.50, TRUE, 0.15, (SELECT ID FROM USERS WHERE USER_NAME = 'Kroger'));

INSERT INTO SUBSCRIPTION (USER_ID, CONTACT_TYPE, PREFERENCE_TYPE, RETAILER_USERNAME) VALUES
((SELECT ID FROM USERS WHERE USER_NAME = 'John Smith'), 'TEXT', 'DAIRY', 'Metro'),
((SELECT ID FROM USERS WHERE USER_NAME = 'Emily Davis'), 'EMAIL', 'PERISHABLE', 'Kroger'),
((SELECT ID FROM USERS WHERE USER_NAME = 'Michael Brown'), 'TEXT', 'CARBOHYDRATE', 'BJs'),
((SELECT ID FROM USERS WHERE USER_NAME = 'Goodwill'), 'EMAIL', 'DAIRY', 'Aldi'),
((SELECT ID FROM USERS WHERE USER_NAME = 'UNICEF'), 'TEXT', 'PERISHABLE', 'Kroger'),
((SELECT ID FROM USERS WHERE USER_NAME = 'Habitat for Humanity'), 'EMAIL', 'DRINK', 'BJs');


select * from USERS;
select * from SUBSCRIPTION;
select * from FOOD;
select * from SURPLUS_FOOD;
select * from ALERT;